% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cluster_fold_similarity.r
\name{clusterFoldSimilarity}
\alias{clusterFoldSimilarity}
\title{Calculate cluster similarity between clusters from different single cell samples.}
\usage{
clusterFoldSimilarity(
  sceList = NULL,
  sampleNames = NULL,
  topN = 1,
  topNFeatures = 1,
  nSubsampling = 10
)
}
\arguments{
\item{sceList}{List. A list of Single Cell Experiments or Seurat objects. At least 2 are needed. The objects are expected to have cluster or label groups set as identity class.}

\item{sampleNames}{Character Vector. Specify the sample names, if not a number corresponding with its position on (sceList).}

\item{topN}{Numeric. Specifies the number of target clusters with best similarity to report for each cluster comparison (default 1). If set to Inf, then all similarity values from all possible pairs of clusters are returned.}

\item{topNFeatures}{Numeric. Number of top features that explains the clusters similarity to report for each cluster comparison (default 1). If topN = Inf then topNFeatures is automatically set to 1.}

\item{nSubsampling}{Numeric. Number of random sampling of cells to achieve fold change stability (default 10).}
}
\value{
The function returns a DataFrame containing the best top similarities between all possible pairs of single cell samples. Column values are:
\tabular{ll}{
   \code{similarityValue} \tab The top similarity value calculated between datasetL:clusterL and datasetR. \cr
   \tab \cr
   \code{sem} \tab Standar Error of the Mean (SEM) of the mean of the values of the coeficient calculated for all genes. \cr
   \tab \cr
   \code{datasetL} \tab Dataset left, the dataset/sample which has been used to be compared.  \cr
   \tab \cr
   \code{clusterL} \tab Cluster left, the cluster source from datasetL which has been compared. \cr
   \tab \cr
   \code{datasetR} \tab Dataset right, the dataset/sample used for comparison against datasetL. \cr
   \tab \cr
   \code{clusterR} \tab Cluster right, the cluster target from datasetR which is being compared with the clusterL from datasetL. \cr
   \tab \cr
   \code{topFeatureConserved} \tab The features (e.g.: genes, peaks...) that most contributed to the similarity between clusterL & clusterR. \cr
}
}
\description{
`clusterFoldSimilarity()` returns a dataframe containing the best top similarities between all possible pairs of single cell samples.
}
\details{
This function will calculate a similarity coeficient using the fold changes of shared features (e.g.:genes for a single-cell RNA-Seq, peaks for ATAC-Seq) among clusters, or user-defined-groups, from different samples/batches. The similarity coeficient
is calculated using the dotproduct of every pairwise combination of Fold Changes between a source cluster/group i from sample n and all the target clusters/groups in sample j.
}
\examples{
if (requireNamespace("Seurat") & requireNamespace("SingleCellExperiment") & requireNamespace("scRNAseq")){
library(ClusterFoldSimilarity)
# Mouse brain single-cell RNA-seq 1 from Romanov et. al.
mouse.brain.romanov <- scRNAseq::RomanovBrainData(ensembl = TRUE)
colnames(mouse.brain.romanov) <- colData(mouse.brain.romanov)$cellID
rownames(colData(mouse.brain.romanov)) <- colData(mouse.brain.romanov)$cellID
singlecell.1.seurat <- CreateSeuratObject(counts = counts(mouse.brain.romanov),meta.data = as.data.frame(colData(mouse.brain.romanov)))

# Mouse brain single-cell RNA-seq 2 from Zeisel et. al.
mouse.brain.zei <- scRNAseq::ZeiselBrainData(ensembl = TRUE)
singlecell.2.seurat <- CreateSeuratObject(counts = counts(mouse.brain.zei),meta.data = as.data.frame(colData(mouse.brain.zei)))

# Create a list with the unprocessed single-cell datasets
singlecell.object.list <- list(singlecell.1.seurat,singlecell.2.seurat)
# Apply the same processing to each dataset and return a list of single-cell analysis
singlecell.object.list <- lapply(X = singlecell.object.list, FUN = function(x){
  x <- NormalizeData(x)
  x <- FindVariableFeatures(x, selection.method = "vst", nfeatures = 1000)
  x <- ScaleData(x,features = VariableFeatures(x))
  x <- RunPCA(x, features = VariableFeatures(object = x))
  x <- FindNeighbors(x, dims = seq(10))
  x <- FindClusters(x, resolution = 0.1)
})
# Calculate the similarity between the two datasets:
similarity.table <- clusterFoldSimilarity(sceList=singlecell.object.list, topN=1)
head(similarity.table)
}
}
\author{
Oscar Gonzalez-Velasco
}
